import requests, os

PLACE_ID = os.environ['14038329225']
TARGET_USER_ID = int(os.environ['31558822'])
WEBHOOK_URL = os.environ['658358324856619078']

url = f"https://games.roblox.com/v1/games/{PLACE_ID}/servers/Public?sortOrder=Asc&limit=10"
response = requests.get(url)
data = response.json()

found = False
for server in data.get("data", []):
    for player in server.get("players", []):
        print(f"Found player: {player['name']} ({player['id']})")  # Debug line
        if player["id"] == TARGET_USER_ID:
            found = True

if found:
    message = {"content": f"<@YOUR_DISCORD_ID> your tracked player just joined a public server!"}
else:
    message = {"content": " Player still offline."}

requests.post(WEBHOOK_URL, json=message)
